# ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½ä¼˜åŒ– - è¯¦ç»†æ¸…å•

## å½“å‰è¿›åº¦ (60% å®Œæˆ)

### âœ… å·²å®Œæˆ
- [x] ESLint é…ç½®è®¾ç½®
- [x] å†—ä½™æ–‡ä»¶æ¸…ç† (åˆ é™¤äº† .bak å’Œ temp æ–‡ä»¶)
- [x] Package.json è„šæœ¬æ›´æ–°
- [x] TypeScript ç±»å‹ç³»ç»Ÿå»ºç«‹
- [x] ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿåˆ›å»º
- [x] æ ¸å¿ƒ API æœåŠ¡æ–‡ä»¶ä¼˜åŒ–
  - [x] app/lib/ave-api-service.ts âœ…
  - [x] app/lib/api-utils.ts âœ…
  - [x] app/api/lib/cache.ts âœ…
  - [x] app/api/lib/errors.ts âœ…
  - [x] app/api/token-details/route.ts (éƒ¨åˆ†) âœ…

### ğŸ”„ è¿›è¡Œä¸­
- [ ] Console è°ƒç”¨æ›¿æ¢ (çº¦ 300+ ä¸ªè°ƒç”¨)
  - [ ] API è·¯ç”±æ–‡ä»¶ (ä¼˜å…ˆçº§é«˜)
  - [ ] ç»„ä»¶æ–‡ä»¶ (ä¼˜å…ˆçº§ä¸­)
  - [ ] é¡µé¢æ–‡ä»¶ (ä¼˜å…ˆçº§ä½)

### â³ å¾…å¼€å§‹
- [ ] TypeScript é…ç½®å¢å¼º
- [ ] å¼€å‘å·¥å…·é…ç½®

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’

### ç«‹å³æ‰§è¡Œ (ä»Šæ—¥)
1. **ç»§ç»­æ›¿æ¢ API è·¯ç”±ä¸­çš„ console è°ƒç”¨**
   - ä¼˜å…ˆå¤„ç†ï¼šæ ¸å¿ƒ API è·¯ç”± (token-*, prices, search)
   - ç„¶åå¤„ç†ï¼šä¸»è¦ç»„ä»¶æ–‡ä»¶

2. **åˆ›å»ºæ—¥å¿—æ›¿æ¢è„šæœ¬**
   - è‡ªåŠ¨åŒ–æ›¿æ¢å¸¸è§æ¨¡å¼
   - å‡å°‘æ‰‹åŠ¨å·¥ä½œé‡

### æœ¬å‘¨å†…å®Œæˆ
1. **å®Œæˆ 50% çš„ console æ›¿æ¢**
2. **TypeScript é…ç½®ä¼˜åŒ–** 
3. **ç¬¬ä¸€è½®æµ‹è¯•éªŒè¯**

## ç»Ÿè®¡æ•°æ®
- **æ€» console è°ƒç”¨æ•°**: ~300 ä¸ª
- **å·²æ›¿æ¢**: ~30 ä¸ª (API æœåŠ¡å±‚ + åŸºç¡€è®¾æ–½)
- **å¾…æ›¿æ¢**: ~270 ä¸ª
- **ä¼°è®¡å®Œæˆæ—¶é—´**: 2-3 å¤©

## æŠ€æœ¯å€ºåŠ¡æ¸…ç†
âœ… **å·²è§£å†³**:
- TypeScript ç±»å‹ä¸åŒ¹é…é—®é¢˜
- ESLint é…ç½®æ­£ç¡®å·¥ä½œ
- æ—¥å¿—ç³»ç»Ÿæ¶æ„å»ºç«‹

âš ï¸ **å‘ç°çš„é—®é¢˜**:
- å¤§é‡ API æ–‡ä»¶åŒ…å«ä¸šåŠ¡é€»è¾‘å’Œæ—¥å¿—æ··åˆ
- éƒ¨åˆ†æ–‡ä»¶ç¼ºå°‘é”™è¯¯å¤„ç†
- éœ€è¦æ›´å¥½çš„ç»“æ„åŒ–æ—¥å¿—

## éªŒè¯æ ‡å‡†
- [x] TypeScript ç¼–è¯‘é€šè¿‡
- [x] ESLint åŸºç¡€é…ç½®å·¥ä½œ  
- [x] æ—¥å¿—è¾“å‡ºæ ¼å¼æ­£ç¡®
- [ ] åº”ç”¨åŠŸèƒ½æ­£å¸¸
- [ ] æ„å»ºæˆåŠŸ

## ğŸ“‹ æ€»è§ˆ
**ç›®æ ‡**: å»ºç«‹ä»£ç è´¨é‡åŸºç¡€è®¾æ–½ï¼Œæå‡ç±»å‹å®‰å…¨æ€§å’Œå¼€å‘è§„èŒƒ  
**é¢„è®¡è€—æ—¶**: 2-3 å‘¨  
**ä¼˜å…ˆçº§**: P0 (å…³é”®)

---

## ğŸ”§ ä»»åŠ¡1: TypeScript é…ç½®å¼ºåŒ–

### 1.1 å‡çº§ tsconfig.json
**æ–‡ä»¶**: `tsconfig.json`

**å½“å‰é—®é¢˜**:
```json
{
  "strict": false,
  "noImplicitAny": false,
  "target": "es2015"
}
```

**ä¼˜åŒ–ç›®æ ‡**:
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "strict": true,
    "noImplicitAny": true,
    "exactOptionalPropertyTypes": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "noImplicitOverride": true,
    "noPropertyAccessFromIndexSignature": true
  }
}
```

**é¢„æœŸç»“æœ**: TypeScript ç¼–è¯‘å™¨å°†æ£€æµ‹å‡ºçº¦ 200+ ä¸ªç±»å‹é”™è¯¯éœ€è¦ä¿®å¤

### 1.2 åˆ›å»ºç»Ÿä¸€ç±»å‹å®šä¹‰ç³»ç»Ÿ
**æ–°å¢ç›®å½•ç»“æ„**:
```
app/types/
â”œâ”€â”€ index.ts          # å¯¼å‡ºæ‰€æœ‰ç±»å‹
â”œâ”€â”€ api.ts           # API å“åº”ç±»å‹
â”œâ”€â”€ token.ts         # ä»£å¸ç›¸å…³ç±»å‹  
â”œâ”€â”€ wallet.ts        # é’±åŒ…ç›¸å…³ç±»å‹
â”œâ”€â”€ chart.ts         # å›¾è¡¨ç›¸å…³ç±»å‹
â”œâ”€â”€ common.ts        # é€šç”¨ç±»å‹
â””â”€â”€ environment.ts   # ç¯å¢ƒå˜é‡ç±»å‹
```

**å…·ä½“ä»»åŠ¡**:
- [ ] åˆ›å»º `app/types/api.ts` - ç»Ÿä¸€ API å“åº”æ¥å£
- [ ] åˆ›å»º `app/types/token.ts` - ä»£å¸æ•°æ®ç»“æ„
- [ ] åˆ›å»º `app/types/wallet.ts` - é’±åŒ…çŠ¶æ€ç±»å‹  
- [ ] åˆ›å»º `app/types/common.ts` - é€šç”¨å·¥å…·ç±»å‹
- [ ] æ›´æ–°æ‰€æœ‰ç°æœ‰ç±»å‹æ–‡ä»¶ä½¿ç”¨æ–°ç»“æ„

### 1.3 ä¿®å¤ `any` ç±»å‹é—®é¢˜
**å—å½±å“æ–‡ä»¶** (æ ¹æ®ä»£ç åˆ†æ):
- `app/lib/ave-api-service.ts` - 14+ ä¸ª `any` ç±»å‹
- `app/components/TokenDetailsCard.tsx` - 8+ ä¸ª `any` ç±»å‹
- `app/hooks/use-api-data.ts` - 6+ ä¸ª `any` ç±»å‹
- `app/api/token-holders/route.ts` - 10+ ä¸ª `any` ç±»å‹

**å…·ä½“ä»»åŠ¡**:
- [ ] ä¸º API å“åº”åˆ›å»ºå…·ä½“æ¥å£
- [ ] æ›¿æ¢ç»„ä»¶ props ä¸­çš„ `any` ç±»å‹
- [ ] ä¸ºäº‹ä»¶å¤„ç†å™¨æ·»åŠ æ­£ç¡®ç±»å‹
- [ ] ä¸ºç¬¬ä¸‰æ–¹åº“æ·»åŠ ç±»å‹å£°æ˜

---

## ğŸ”§ ä»»åŠ¡2: ESLint é…ç½®å®Œå–„

### 2.1 é…ç½® .eslintrc.json
**å½“å‰çŠ¶æ€**: æ–‡ä»¶ä¸ºç©º
**ç›®æ ‡é…ç½®**:
```json
{
  "extends": [
    "next/core-web-vitals",
    "@typescript-eslint/recommended",
    "@typescript-eslint/recommended-requiring-type-checking"
  ],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "project": "./tsconfig.json"
  },
  "plugins": ["@typescript-eslint"],
  "rules": {
    "no-console": "warn",
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/no-unused-vars": "error",
    "@typescript-eslint/prefer-nullish-coalescing": "error",
    "@typescript-eslint/prefer-optional-chain": "error",
    "prefer-const": "error",
    "no-var": "error"
  },
  "ignorePatterns": ["lib/klinecharts/", "*.js"]
}
```

### 2.2 å®‰è£…æ‰€éœ€ä¾èµ–
```bash
npm install -D @typescript-eslint/parser @typescript-eslint/eslint-plugin
npm install -D prettier eslint-config-prettier eslint-plugin-prettier
npm install -D husky lint-staged
```

### 2.3 é…ç½® Prettier
**æ–°å¢æ–‡ä»¶**: `.prettierrc.json`
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": true,
  "printWidth": 80,
  "tabWidth": 2,
  "useTabs": false
}
```

### 2.4 è®¾ç½® pre-commit é’©å­
**æ–°å¢æ–‡ä»¶**: `.husky/pre-commit`
```bash
#!/usr/bin/env sh
npx lint-staged
```

**æ–°å¢æ–‡ä»¶**: `lint-staged.config.js`
```js
module.exports = {
  '*.{ts,tsx}': ['eslint --fix', 'prettier --write'],
  '*.{js,jsx}': ['eslint --fix', 'prettier --write'],
  '*.{json,md}': ['prettier --write']
}
```

---

## ğŸ”§ ä»»åŠ¡3: æ—¥å¿—ç³»ç»Ÿç»Ÿä¸€åŒ–

### 3.1 åˆ›å»ºç»Ÿä¸€ Logger ç±»
**æ–°å¢æ–‡ä»¶**: `lib/logger.ts`
```typescript
enum LogLevel {
  DEBUG = 0,
  INFO = 1,
  WARN = 2,
  ERROR = 3
}

interface LogEntry {
  level: LogLevel;
  message: string;
  data?: any;
  timestamp: number;
  context?: string;
}

class Logger {
  private isDev = process.env.NODE_ENV === 'development';
  private minLevel = this.isDev ? LogLevel.DEBUG : LogLevel.WARN;
  
  debug(message: string, data?: any, context?: string): void
  info(message: string, data?: any, context?: string): void  
  warn(message: string, data?: any, context?: string): void
  error(message: string, error?: Error | any, context?: string): void
  
  private log(level: LogLevel, message: string, data?: any, context?: string): void
  private formatMessage(entry: LogEntry): string
  private shouldLog(level: LogLevel): boolean
}

export const logger = new Logger();
```

### 3.2 æ›¿æ¢ç°æœ‰ console è°ƒç”¨
**éœ€è¦æ›´æ–°çš„æ–‡ä»¶** (æ ¹æ® grep æœç´¢ç»“æœ):

**é«˜ä¼˜å…ˆçº§æ–‡ä»¶** (API å…³é”®è·¯å¾„):
- [ ] `app/lib/ave-api-service.ts` - 25+ console è°ƒç”¨
- [ ] `app/api/token-holders/route.ts` - 8+ console è°ƒç”¨  
- [ ] `app/lib/api-utils.ts` - 15+ console è°ƒç”¨
- [ ] `app/hooks/use-api-data.ts` - 4+ console è°ƒç”¨

**ä¸­ä¼˜å…ˆçº§æ–‡ä»¶** (UI ç»„ä»¶):
- [ ] `app/discover/page.tsx` - 12+ console è°ƒç”¨
- [ ] `app/components/MainstreamTokens.tsx` - console è°ƒç”¨
- [ ] `app/token/[blockchain]/[address]/page.tsx` - 5+ console è°ƒç”¨

**ä½ä¼˜å…ˆçº§æ–‡ä»¶** (å·¥å…·ç±»):
- [ ] `lib/db.ts` - 3 console è°ƒç”¨
- [ ] `app/lib/trending-service.ts` - 6+ console è°ƒç”¨

### 3.3 æ›´æ–°æ—¥å¿—ä½¿ç”¨æ¨¡å¼
**è¿ç§»ç¤ºä¾‹**:
```typescript
// ä¹‹å‰
console.log('[getTokenDetails] åŸå§‹APIå“åº”:', response);
console.error('è·å–ä»£å¸è¯¦æƒ…é”™è¯¯:', error);

// ä¹‹å  
logger.debug('åŸå§‹APIå“åº”', response, 'getTokenDetails');
logger.error('è·å–ä»£å¸è¯¦æƒ…å¤±è´¥', error, 'getTokenDetails');
```

---

## ğŸ”§ ä»»åŠ¡4: æ¸…ç†å’Œé‡æ„å‡†å¤‡

### 4.1 åˆ é™¤å†—ä½™æ–‡ä»¶
**éœ€è¦åˆ é™¤çš„æ–‡ä»¶**:
- [ ] `app/components/TokenDetailsCard.tsx.bak` (42KB å¤‡ä»½æ–‡ä»¶)
- [ ] `app/components/ChartWrapper.tsx.bak` (26KB å¤‡ä»½æ–‡ä»¶)  
- [ ] `next.config.mjs.bak` (å¤‡ä»½é…ç½®æ–‡ä»¶)
- [ ] `temp-next.config.mjs` (ä¸´æ—¶æ–‡ä»¶)

### 4.2 ç¯å¢ƒå˜é‡ç±»å‹åŒ–
**æ–°å¢æ–‡ä»¶**: `app/types/environment.ts`
```typescript
declare global {
  namespace NodeJS {
    interface ProcessEnv {
      MONGODB_URI: string;
      AVE_API_KEY: string;
      NEXT_PUBLIC_API_URL?: string;
      NODE_ENV: 'development' | 'production' | 'test';
    }
  }
}
```

### 4.3 æ›´æ–° package.json è„šæœ¬
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "lint:fix": "next lint --fix",
    "type-check": "tsc --noEmit",
    "format": "prettier --write .",
    "format:check": "prettier --check .",
    "pre-commit": "lint-staged"
  }
}
```

---

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### ç¼–è¯‘æŒ‡æ ‡
- [ ] TypeScript ç¼–è¯‘æ— é”™è¯¯ (0 errors)
- [ ] ESLint æ£€æŸ¥é€šè¿‡ (0 errors, <10 warnings)
- [ ] æ„å»ºæˆåŠŸ (`npm run build`)

### ä»£ç è´¨é‡æŒ‡æ ‡  
- [ ] ç§»é™¤æ‰€æœ‰ `any` ç±»å‹ (ç›®æ ‡: 90%+ ç±»å‹è¦†ç›–)
- [ ] ç»Ÿä¸€æ—¥å¿—è°ƒç”¨ (ç›®æ ‡: æ›¿æ¢ 80%+ console è°ƒç”¨)
- [ ] åˆ é™¤å†—ä½™ä»£ç  (ç›®æ ‡: å‡å°‘ 5%+ ä»£ç é‡)

### å¼€å‘ä½“éªŒæŒ‡æ ‡
- [ ] VS Code ç±»å‹æç¤ºæ­£å¸¸
- [ ] è‡ªåŠ¨æ ¼å¼åŒ–å·¥ä½œæ­£å¸¸  
- [ ] pre-commit é’©å­ç”Ÿæ•ˆ
- [ ] æ„å»ºæ—¶é—´æ— æ˜æ˜¾å¢åŠ 

---

## ğŸš¨ é£é™©ç‚¹å’Œæ³¨æ„äº‹é¡¹

### æ½œåœ¨é—®é¢˜
1. **TypeScript ä¸¥æ ¼æ¨¡å¼**: å¯èƒ½æš´éœ² 100+ ç±»å‹é”™è¯¯
2. **ç¬¬ä¸‰æ–¹åº“å…¼å®¹æ€§**: klinecharts ç­‰åº“å¯èƒ½éœ€è¦ç±»å‹å£°æ˜
3. **æ„å»ºæ—¶é—´**: ä¸¥æ ¼ç±»å‹æ£€æŸ¥å¯èƒ½å¢åŠ æ„å»ºæ—¶é—´

### ç¼“è§£ç­–ç•¥
1. **æ¸è¿›å¼è¿ç§»**: ä¸€ä¸ªæ¨¡å—ä¸€ä¸ªæ¨¡å—åœ°ä¿®å¤ç±»å‹é”™è¯¯
2. **ç±»å‹å£°æ˜**: ä¸ºç¼ºå°‘ç±»å‹çš„åº“åˆ›å»º `.d.ts` æ–‡ä»¶
3. **CI/CD ä¼˜åŒ–**: ä½¿ç”¨ç±»å‹æ£€æŸ¥ç¼“å­˜

### å›æ»šè®¡åˆ’
å¦‚æœé‡åˆ°é˜»å¡é—®é¢˜:
1. ä¸´æ—¶ç¦ç”¨ç›¸å…³ ESLint è§„åˆ™
2. å°† TypeScript strict æ¨¡å¼æš‚æ—¶é™çº§  
3. ä¿ç•™åŸå§‹é…ç½®æ–‡ä»¶å¤‡ä»½

---

## ğŸ¯ ä¸‹ä¸€æ­¥é¢„å‘Š

å®Œæˆç¬¬ä¸€é˜¶æ®µåï¼Œå°†è·å¾—ï¼š
- âœ… ç±»å‹å®‰å…¨çš„ä»£ç åŸºç¡€
- âœ… ä¸€è‡´çš„ä»£ç é£æ ¼å’Œè´¨é‡æ ‡å‡†  
- âœ… ç»Ÿä¸€çš„æ—¥å¿—ç®¡ç†ç³»ç»Ÿ
- âœ… è‡ªåŠ¨åŒ–çš„ä»£ç æ£€æŸ¥æµç¨‹

è¿™å°†ä¸ºç¬¬äºŒé˜¶æ®µçš„æ¶æ„é‡æ„æä¾›åšå®åŸºç¡€ã€‚ 